{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchPhotos = (searchQuery, page) => {\n  const axiosOptions = {\n    params: {\n      key: '45589223-69f3ad275007a1fe85231a89e',\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n    },\n  };\n\n  return axios.get('', axiosOptions);\n};\n","export const createGalleryCard = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n        class=\"gallery-image\"\n        src=\"${webformatURL}\"\n        alt=\"${tags}\"/>\n      </a>\n      <ul class=\"gallary-descr\">\n        <li class=\"gallary-descr-item\">\n          <h2 class=\"gallary-descr-item-title\">Likes</h2>\n          <p class=\"gallary-descr-item-num\">${likes}</p>\n        </li>\n        <li class=\"gallary-descr-item\">\n          <h2 class=\"gallary-descr-item-title\">Views</h2>\n          <p class=\"gallary-descr-item-num\">${views}</p>\n        </li>\n        <li class=\"gallary-descr-item\">\n          <h2 class=\"gallary-descr-item-title\">Comments</h2>\n          <p class=\"gallary-descr-item-num\">${comments}</p>\n        </li>\n        <li class=\"gallary-descr-item\">\n          <h2 class=\"gallary-descr-item-title\">Downloads</h2>\n          <p class=\"gallary-descr-item-num\">${downloads}</p>\n        </li>\n      </ul>\n  </li>\n  `;\n};\n","import { fetchPhotos } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { createGalleryCard } from './js/render-functions';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadmoreEl = document.querySelector('.js-load-more');\n\nlet currentPage = 1;\nlet searchValue = '';\nlet cardHeight = 0;\nlet totalPages = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionsData: 'alt',\n});\n\nconst onSearchFormSubmit = async e => {\n  try {\n    e.preventDefault();\n    loaderEl.classList.remove('is-hidden');\n\n    searchValue = searchFormEl.elements.user_query.value.trim();\n\n    if (!searchValue) {\n      iziToast.error({\n        message: 'Enter what we are looking for',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        messageColor: '#fafafb',\n        iconColor: '#fafafb',\n      });\n      return;\n    }\n\n    currentPage = 1;\n\n    const response = await fetchPhotos(searchValue, currentPage);\n    if (response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        messageColor: '#fafafb',\n        iconColor: '#fafafb',\n      });\n\n      loadmoreEl.classList.add('is-hidden');\n      galleryEl.innerHTML = '';\n      searchFormEl.reset();\n      return;\n    }\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCard(imgDetails))\n      .join('');\n    galleryEl.innerHTML = galleryCardsTemplate;\n    cardHeight = galleryEl.querySelector('li').getBoundingClientRect().height;\n\n    totalPages = Math.ceil(response.data.totalHits / 15);\n    if (currentPage >= totalPages) {\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    }\n    loadmoreEl.classList.remove('is-hidden');\n    lightbox.refresh();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    searchFormEl.reset();\n    loaderEl.classList.add('is-hidden');\n  }\n};\n\nconst OnLoadMoreBtnClick = async event => {\n  try {\n    currentPage++;\n    const response = await fetchPhotos(searchValue, currentPage);\n    const galleryCardsTemplate = response.data.hits\n      .map(imgDetails => createGalleryCard(imgDetails))\n      .join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n    lightbox.refresh();\n\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    totalPages = Math.ceil(response.data.totalHits / 15);\n\n    if (currentPage >= totalPages) {\n      loadmoreEl.classList.add('is-hidden');\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadmoreEl.addEventListener('click', OnLoadMoreBtnClick);\n"],"names":["axios","fetchPhotos","searchQuery","page","axiosOptions","createGalleryCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchFormEl","galleryEl","loaderEl","loadmoreEl","currentPage","searchValue","cardHeight","totalPages","lightbox","SimpleLightbox","onSearchFormSubmit","e","iziToast","response","galleryCardsTemplate","imgDetails","err","OnLoadMoreBtnClick","event"],"mappings":"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"}